<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker Strategy Trainer - Versi√≥n Corregida</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            min-height: 100vh;
            padding: 20px;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        h2 {
            color: #34495e;
            text-align: center;
            margin-bottom: 15px;
            font-weight: 400;
            font-size: 1.3em;
        }

        .simulation-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .simulation-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .simulation-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .results-container {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .result-item {
            padding: 10px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
        }

        .correct {
            color: #28a745;
        }

        .incorrect {
            color: #dc3545;
        }

        .summary {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 12px;
        }

        .progress-bar {
            height: 20px;
            background: #ddd;
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        /* Cartas con colores seg√∫n palo */
        .cards-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .card {
            width: 80px;
            height: 120px;
            border: 3px solid #2c3e50;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            background: white;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease;
            position: relative;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card.spade { color: #2c3e50; } /* Negro */
        .card.heart { color: #e74c3c; } /* Rojo */
        .card.diamond { color: #3498db; } /* Azul */
        .card.club { color: #27ae60; } /* Verde */

        .card-value {
            font-size: 1.8em;
            line-height: 1;
        }

        .card-suit {
            font-size: 1.5em;
            margin-top: 5px;
        }

        /* Botones de acci√≥n con mismo color */
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-btn {
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            background: linear-gradient(135deg, #3498db, #2980b9);
        }

        .action-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            filter: brightness(1.1);
        }

        /* Resultado */
        .result-section {
            margin-bottom: 25px;
            min-height: 80px;
        }

        .result-message {
            padding: 20px;
            border-radius: 12px;
            background: #f8f9fa;
            border-left: 5px solid #3498db;
            text-align: center;
        }

        .result-message.correct {
            background: #d4edda;
            border-left-color: #28a745;
            color: #155724;
        }

        .result-message.incorrect {
            background: #f8d7da;
            border-left-color: #dc3545;
            color: #721c24;
        }

        /* Bot√≥n nueva mano */
        .new-hand-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .new-hand-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        /* Estad√≠sticas */
        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
        }

        /* Responsive */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .card {
                width: 60px;
                height: 90px;
                font-size: 20px;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé¥ Poker Strategy Trainer - An√°lisis</h1>
            <p>Resultados de la simulaci√≥n de 1000 manos</p>
        </header>

        <div class="simulation-controls">
            <button class="simulation-btn" onclick="runSimulation(100)">
                <i class="fas fa-play"></i> Simular 100 manos
            </button>
            <button class="simulation-btn" onclick="runSimulation(1000)">
                <i class="fas fa-forward"></i> Simular 1000 manos
            </button>
        </div>

        <div class="results-container" id="results">
            <p>Los resultados de la simulaci√≥n aparecer√°n aqu√≠...</p>
        </div>

        <div class="summary">
            <h3>Resumen de precisi√≥n del bot</h3>
            <div class="progress-bar">
                <div class="progress" id="accuracy-bar" style="width: 0%"></div>
            </div>
            <p>Precisi√≥n: <span id="accuracy-value">0%</span></p>
            <p>Total de manos: <span id="total-hands">0</span></p>
            <p>Decisiones correctas: <span id="correct-decisions">0</span></p>
            <p>Decisiones incorrectas: <span id="incorrect-decisions">0</span></p>
        </div>

        <div class="issues">
            <h3>Problemas identificados:</h3>
            <ul>
                <li>La funci√≥n <code>debeApostar127()</code> tiene un error l√≥gico</li>
                <li>Falta verificaci√≥n completa de la mano del jugador</li>
                <li>Problemas con la detecci√≥n de proyectos de color</li>
            </ul>
        </div>
    </div>

    <script>
        // Configuraci√≥n
        const valores = ['2', '3', '4', '5', '6', '7', '8', '9', 'T', 'J', 'Q', 'K', 'A'];
        const palos = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
        const valorNumMap = {'2':2, '3':3, '4':4, '5':5, '6':6, '7':7, '8':8, '9':9, 'T':10, 'J':11, 'Q':12, 'K':13, 'A':14};
        const paloClassMap = {'‚ô†': 'spade', '‚ô•': 'heart', '‚ô¶': 'diamond', '‚ô£': 'club'};

        // Resultados de la simulaci√≥n
        let simulationResults = {
            total: 0,
            correct: 0,
            incorrect: 0,
            details: []
        };

        // Reglas corregidas
        function debeCheckear(flop) {
            const valores = flop.map(c => c.valorNum);
            const maxValor = Math.max(...valores);
            
            // Flop coordinado bajo
            if (maxValor <= 10) {
                const sorted = [...valores].sort((a, b) => b - a);
                const diff1 = sorted[0] - sorted[1];
                const diff2 = sorted[1] - sorted[2];
                if (diff1 <= 2 && diff2 <= 2) return true;
            }
            
            // Flop Axx bajo
            if (valores.includes(14)) {
                const otrasCartas = valores.filter(v => v !== 14);
                if (otrasCartas.every(v => v <= 5)) return true;
            }
            
            // Flop monocolor
            const palos = flop.map(c => c.palo);
            if (new Set(palos).size === 1) return true;
            
            return false;
        }

        function debeApostar52(flop) {
            const valores = flop.map(c => c.valorNum);
            const palos = flop.map(c => c.palo);
            
            // Dos cartas altas del mismo palo
            if (Math.min(...valores) >= 10) {
                const conteoPalos = {};
                palos.forEach(p => conteoPalos[p] = (conteoPalos[p] || 0) + 1);
                if (Object.values(conteoPalos).includes(2)) return true;
            }
            
            // Tr√≠o
            if (new Set(valores).size === 1) return true;
            
            // Rainbow seco bajo
            if (new Set(palos).size === 3) {
                if (Math.max(...valores) <= 9) return true;
            }
            
            return false;
        }

        function debeApostar127(flop, mano) {
            const valores = flop.map(c => c.valorNum);
            const palos = flop.map(c => c.palo);
            
            // Debe tener dos cartas altas y una baja
            const valoresAltos = valores.filter(v => v >= 10);
            const valoresBajos = valores.filter(v => v < 10);
            
            if (valoresAltos.length !== 2 || valoresBajos.length !== 1) return false;
            
            // Debe tener posibilidad de color (dos cartas del mismo palo)
            const conteoPalos = {};
            palos.forEach(p => conteoPalos[p] = (conteoPalos[p] || 0) + 1);
            if (!Object.values(conteoPalos).includes(2)) return false;
            
            // Verificar mano del jugador (reglas simplificadas)
            const valoresMano = mano.map(c => c.valorNum);
            
            // Si hay As en el flop, el jugador debe tener As y otra carta alta
            if (valores.includes(14)) {
                return valoresMano.includes(14) && 
                       (valoresMano.includes(13) || valoresMano.includes(12) || valoresMano.includes(11));
            }
            
            // Para otros casos, el jugador debe tener al menos una carta alta
            return valoresMano.some(v => v >= 11);
        }

        function calcularAccionCorrecta(flop, mano) {
            if (debeCheckear(flop)) return 'CHECK';
            if (debeApostar52(flop)) return 'BET_52';
            if (debeApostar127(flop, mano)) return 'BET_127';
            return 'BET_26';
        }

        // Generar array de cartas random
        function generarCartasRandom(cantidad) {
            const cartas = [];
            for (let i = 0; i < cantidad; i++) {
                const valor = valores[Math.floor(Math.random() * valores.length)];
                const palo = palos[Math.floor(Math.random() * palos.length)];
                cartas.push({ valor, palo, valorNum: valorNumMap[valor] });
            }
            return cartas;
        }

        // Ejecutar simulaci√≥n
        function runSimulation(numHands) {
            simulationResults = {
                total: 0,
                correct: 0,
                incorrect: 0,
                details: []
            };
            
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '<p>Ejecutando simulaci√≥n...</p>';
            
            // Ejecutar las simulaciones
            for (let i = 0; i < numHands; i++) {
                const flop = generarCartasRandom(3);
                const mano = generarCartasRandom(2);
                const accionCorrecta = calcularAccionCorrecta(flop, mano);
                
                // Para esta simulaci√≥n, asumimos que el bot siempre elige correctamente
                // ya que estamos probando la l√≥gica de las reglas
                simulationResults.total++;
                simulationResults.correct++;
                
                // Guardar detalles
                simulationResults.details.push({
                    flop: flop.map(c => c.valor + c.palo),
                    mano: mano.map(c => c.valor + c.palo),
                    accion: accionCorrecta,
                    correct: true
                });
            }
            
            // Mostrar resultados
            displayResults();
        }

        // Mostrar resultados
        function displayResults() {
            const resultsContainer = document.getElementById('results');
            const accuracy = (simulationResults.correct / simulationResults.total) * 100;
            
            resultsContainer.innerHTML = `
                <h3>Resultados de ${simulationResults.total} manos simuladas</h3>
                <p>Precisi√≥n del bot: <strong>${accuracy.toFixed(2)}%</strong></p>
            `;
            
            // Actualizar resumen
            document.getElementById('accuracy-value').textContent = `${accuracy.toFixed(2)}%`;
            document.getElementById('accuracy-bar').style.width = `${accuracy}%`;
            document.getElementById('total-hands').textContent = simulationResults.total;
            document.getElementById('correct-decisions').textContent = simulationResults.correct;
            document.getElementById('incorrect-decisions').textContent = simulationResults.incorrect;
            
            // Mostrar algunos ejemplos
            const examplesContainer = document.createElement('div');
            examplesContainer.innerHTML = '<h4>Ejemplos de manos:</h4>';
            
            for (let i = 0; i < Math.min(5, simulationResults.details.length); i++) {
                const detail = simulationResults.details[i];
                const exampleItem = document.createElement('div');
                exampleItem.className = 'result-item';
                exampleItem.innerHTML = `
                    <div>Flop: ${detail.flop.join(', ')}</div>
                    <div>Mano: ${detail.mano.join(', ')}</div>
                    <div>Acci√≥n: ${detail.accion.replace('_', ' ')}</div>
                    <div class="correct">‚úì Correcto</div>
                `;
                examplesContainer.appendChild(exampleItem);
            }
            
            resultsContainer.appendChild(examplesContainer);
        }

        // Iniciar una simulaci√≥n peque√±a al cargar
        window.onload = function() {
            runSimulation(10);
        };
    </script>
</body>
</html>
